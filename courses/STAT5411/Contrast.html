<!DOCTYPE html>
<html>
<title>Linear Contrasts and Multiple Comparison</title>
<head>
<head>
  <link rel="stylesheet" type="text/css" href="../styles.css">
  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>
</head>
<body>

<h1>Linear contrasts and multiple comparison</h1>
<p><a href="ANOVA.html">Previous</a>&nbsp;&nbsp;&nbsp;<a href="index.html">Back</a>&nbsp;&nbsp;&nbsp;<a href="Factorial.html">Next</a></p>

<figure>
  <img src="contrast1.png", width = "750">
</figure> 

<pre>
    data deer;
        input weight environment $;
        datalines;
        114.7 Wild
        128.9 Wild
        111.5 Wild
        116.4 Wild
        134.5 Wild
        126.7 Wild
        120.6 Wild
        129.59 Wild
        120.4 Ranch
        91.0 Ranch
        119.6 Ranch
        119.4 Ranch
        150.0 Ranch
        169.7 Ranch
        100.9 Ranch
        76.1 Ranch
        103.1 Zoo
        90.7 Zoo
        129.5 Zoo
        75.8 Zoo
        182.5 Zoo
        76.8 Zoo
        87.3 Zoo
        77.3 Zoo
        ;
    run;
    
    proc glm data=deer;
        class environment;
        model weight = environment;
        estimate 'Wild versus Non-wild' environment 2 -1 -1 / divisor=2;
        estimate 'Zoo versus Ranch' environment 0 -1 1; 
        contrast 'Wild versus Non-wild' environment 2 -1 -1;
        contrast 'Zoo versus Ranch' environment 0 -1 1; 
    run;
</pre>

<p>We use <code>estimate</code> to estimate a given linear contrast, and <code>contrast</code> to test if the linear contrast is equal to zero. For example, we first estimate \(l_1=(2\mu_1-\mu_2-\mu_3)/2\) and \(l_2=\mu_2-\mu_3\). Then we test if these two linear contrasts are zero or not.</p>

<figure>
  <img src="contrast2.png", width = "450">
</figure> 

<p>SAS gives \(\hat{l}_1=5.519375\) and \(\hat{l}_2=-19.98625\). The sums of squares of these two contrasts are \(SS_{l_1}=162.472\) and \(SS_{l_2}=1597.800756\), respectively. The \(p\)-values are \(0.6536\) and \(0.1681\), both of which are greater than \(0.05\). Note that since \(l_1\) and \(l_2\) are orthogonal and the degrees of freedom of <code>environment</code> is \(2\), \(SS_{l_1}+SS_{l_2}=1760.272758=SS_{\text{Between}}\).</p>

<h2>Scheffe's S and Tukey's W methods</h2>

<p>Scheffe's S and Tukey's W methods are commonly used in multiple comparison. They can be easily accessed in SAS as well.</p>

<pre>
    proc glm data=deer;
        class environment;
        model weight = environment;
        means environment / alpha=0.05 scheffe tukey;
    run;
</pre>

<figure>
  <img src="contrast3.png", width = "650">
</figure> 

<figure>
  <img src="contrast4.png", width = "450">
</figure> 

<p>Treatments connected by the same vertical bar are not significantly different. In this example, all three environments are similar using both methods.</p>

<p><a href="ANOVA.html">Previous</a>&nbsp;&nbsp;&nbsp;<a href="index.html">Back</a>&nbsp;&nbsp;&nbsp;<a href="Factorial.html">Next</a></p>

</body>
</html>


