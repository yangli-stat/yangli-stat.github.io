<!DOCTYPE html>
<html>
<title>Factorial Design</title>
<head>
<head>
  <link rel="stylesheet" type="text/css" href="../styles.css">
  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>
</head>
<body>

<h1>Factorial designs</h1>
<p><a href="Contrast.html">Previous</a>&nbsp;&nbsp;&nbsp;<a href="index.html">Back</a>&nbsp;&nbsp;&nbsp;<a href="BlockDesign.html">Next</a></p>

<p>In a factorial design with two factors, let's assume there are \(a\) levels in the first factor, \(b\) levels in the second factor. For each combination of treatment, there are \(n\) observations. The factor effects model is</p>
$$
y_{ijk} = \mu + \tau_i + \beta_j + (\tau\beta)_{ij} + \epsilon_{ijk}
$$
<p>where \(i=1,\dots, a\), \(j=1,\dots, b\), and \(k=1,\dots, n\).</p>

<p>Let's use Example 14.6 as an illustration. There are four different pesticides and three varieties. For each combination, there are 2 replicates.</p>

<figure>
  <img src="SASFactorial1.png" width = "350">
</figure> 

<pre>
    filename myfile url 'http://www.d.umn.edu/~yangli/5411/data/pesticides.txt';
    /* The first column is the observed yield. The second column is the */
    /* pesticide factor, and the third column is the variety factor */
    data pesticides;
        infile myfile;
        input yield pesticide variety;
    run;

    proc print data=pesticides;
    run;
</pre>

<figure>
  <img src="SASFactorial2.png" width = "200">
</figure> 

<p>There are five terms on the right side of the model. Since SAS will automatically add the constant term \(\mu\) and the random error \(\epsilon_{ijk}\), we only need to specify three terms in the <code>model</code> statement. You can use</p>

<pre>
    proc glm data=pesticides;
        class pesticide variety;
        model yield=pesticide variety pesticide*variety;
    run;
</pre>

<p>or</p>

<pre>
    proc glm data=pesticides;
        class pesticide variety;
        model yield=pesticide | variety;
    run;
</pre>

<p>These two methods are equivalent. The first <code>model</code> statement explicitly lists all three terms, while <code>|</code> in the second <code>model</code> statement includes two main effects and their interaction which is the same as the first one.</p>

<figure>
  <img src="SASFactorial3.png" width = "400">
</figure> 

<p>Remember that we test for interaction first. If we do not reject it, we can go ahead and test for two main effects. If there is a rejection, then the main effect of one factor depends on the levels of the other factor. There is no unique answer for the main effects.</p>

<p>SAS also gives you the profile plot which are approximately parallel lines since there is no significant interaction between pesticide and variety.</p>

<figure>
  <img src="SASFactorial4.png" width = "450">
</figure> 

<p><a href="Contrast.html">Previous</a>&nbsp;&nbsp;&nbsp;<a href="index.html">Back</a>&nbsp;&nbsp;&nbsp;<a href="BlockDesign.html">Next</a></p>

</body>
</html>


